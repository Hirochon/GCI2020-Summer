# GCI 2020 summer 最終課題

最終課題は第2回コンペで行われた`“Home Credit Default Risk” from Kaggle`のデータを用いて事業提案をするというもの。

え？事業提案？利益を出さなきゃいけない？僕の使ってる日本語とは違う言語みたいだぜ！っていうモチベ。

## 結果
#### 結果待ち

## 課題
あなたはデータサイエンティストとして[Home Credit Group](https://www.homecredit.net/)から業務委託され，事業モデルを提案することになりました。以下の要件を満たす事業モデルについての資料を提出してください。

### 要件
- 提出はスライド形式で、15スライド以内のPDFとする。
- 本講座で学んだ内容（データの可視化・機械学習技術など）を用いる。
- 機械学習に関して事前知識をもたない人間に対する資料としてふさわしいものとする。

### データについて
- データは過去にKaggleで開催されたコンペティション「[Home Credit Default Risk](https://www.kaggle.com/c/home-credit-default-risk/data)」で配布されたものを主として使用してください。（第二回コンペで配布されたデータセットではなく、Kaggleで配布されているデータセットを使用することに注意してください。ここで、データセットが複数に分かれていますが、その全てを使用する必要はありません。）
- 誰でも無償でアクセス可能なオープンデータは用いても構いませんが，その際には出典を明記してください。

## ヒント
### 目的変数について
題材となっているコンペティションではクレジットリスクを目的変数としていますが，最終課題では自由に目的変数を設定して構わない。

### 何を求められるのか？
与えられたデータから収益を上げるための事業を考えます。その際に評価されるのは、事業提案の必然性の論理と事業規模の適切な推定。

### 資料作成の注意点
要件にあるように，作成した資料は機械学習に関して事前知識をもたない人間に対するもの。そのため専門用語の濫用やソースコードのコピー&ペースト等は著しく評価が低くなる可能性がある。

## 考えた事業モデルについて
**🔻コチラのPDFを見ていただくのが一番手っ取り早いです(そのためのスライドだよね！笑)**

https://github.com/Hirochon/GCI2020-Summer/blob/master/FinalTask/AIを用いた融資の改善案について.pdf

### スライドとしてのポイントは5つくらいあります
#### 1. 如何に見やすいスライドを作れるか
  → 可視化できる図は多く。色は3種類。数字を強調したい時は言葉のみで。
#### 2. 如何に少ない文字で情報を伝えられるか
  →　図を使って文字の量を減らす。機械学習に関しての情報を入れすぎない(そもそも自分にそこまでの専門性はない)。
#### 3. 専門用語を乱用していないか
  →　LightGBMの説明は最小限に。色んな友達に見せて改善点を探った。
#### 4. 事業としてのメリットを伝えられるか
  →　利益を超絶！強調！　結果を見せてから徹底的に分かりやすい根拠を見せる。
#### 5. 本気で心を動かすプレゼンとして使えるかどうか(流れを作れているか)
  1. 結論(興味をもたせる)
  2. 問題提起(徹底的に不安にさせる)
  3. 改善案の提示(利益をしっかりと提示)
  4. 安心させる(根拠の説明)
  5. おまけの情報
  6. 行動喚起

### 前処理&モデルの解説
**既存より優れた融資額提案モデルを作る!!**
1. Kaggleでダウンロードできるデータ(applicationのみ)を使用
2. データの中でもdefaultかどうか(TARGET=0or1)で分割
3. defaultしないデータ(TARGET=0)を学習データとして扱う(TARGETとAMT_CREDITはdrop)
4. defaultしなかったデータ(約25000件)を取り出して、defaultしたデータ(約25000件)と結合し、テストデータを作成
5. `3`の学習データを使って、以下モデルで学習
  - 5fold, stratifiedKFold
  - LightGBM Single Model(LGBMRegressor)
6. テストデータで予測した
  - defaultした人への融資額がだけしっかりと減額していた。
  - defaultしなかった人への融資額の変動はとても小さかった
7. 損失が減る！！

## やったこと(時系列順に記述)
### 1. データ探索
**1-1. KaggleのNotebookやDiscussionに上がっている内容などをパラパラ見る**
- Kaggleとの目的が『スコアを上げる⇔事業で収益を上げる』での乖離が見えて、今回の課題の難しさを実感していく。

**1-2. カラムとして何があるのか全てしっかり確認する**
- とりあえずカラムを全て日本語訳する。

### 2. 利益が出る方法を考える
**2-1. TARGETを目的変数にしていると、絶対に誰かと提案被るな…**
- ハナから目的変数をTARGETにするつもりがなかった。
- 結局ずーっと何も思いつかなくて挫折

### 3. 家ランクを使った追加融資の提案作戦
**3-1. 家ランクを作ってそれを予測して、実際との乖離を見る**
- カラムに家の情報が標準化された状態で存在していたので合計して**家ランク**を作ろうとした
- 家に関する情報を抜いたものを学習用データ
- 家に関する情報を足し合わせたものを教師データとして学習
- 実際の家ランクと比較して、差分が大きいと以下の推論ができる
- 差分が大きい→ もっと良い家に住める/いまの家は手放すべき

**3-2. もっと良い家に住めるを使って、追加融資の提案をしようとしたが辞めた**
- KaggleのDiscussionでカザフスタンのデータである可能性を指摘されていた。→家買うことにモチベあるのか？？
- そして与えられたデータの分類に家を買うために融資を依頼する割合が少なすぎた。
- そもそも家ランクが性能の良いものではなかった
- → 『今の家は手放すべき』ジャンルでTARGETごとに比較しても差がなかった
- つまり挫折

**3-3. 諦められないけど、挫折**
- 建築関係で働いている兄に相談したくらいガチで行けると思った。
- もう打てるて無いじゃん…
- どうせ誰にも見られてない意識あるので、メモをおいていきますw
- [家ランク作戦のメモはコチラ](https://github.com/Hirochon/GCI2020-Summer/blob/master/FinalTask/application_house_description.txt)

### 4. シンプルに金と直結してる融資額をどうにかする方向性でいく！
**4-1. どうにかなにかないか！？**
- まさに今のモデルのような構造を思いつく！
- いざテストしてみると『おお！うまくいった！』けど、あれ…leakかこれ…
- 間違えてAMT_CREDITの四則演算を入れてたので除去
- もう一度やってみたところ、先ほどより大きく実測値と予測値で差分が出てきました！

**4-2. これいける！！！**
- どうやってスライド作るか。どうやって提案するかは置いといて、第1関門はクリアできました。
- でもめっちゃここで終わりたくなる。つらみ。
- 今までやりきったことがあまりなかったので、頑張る。その形跡メモもあるので、誰も見てないだろうと決め込んで(2回目)置いとくw
- [最終的な作戦メモはコチラ](https://github.com/Hirochon/GCI2020-Summer/blob/master/FinalTask/application_amt_credit.txt)

### 5. ヤバ最難関過ぎたスライド作成
**5-1. スライド構成どうしたらいいかのか分からなすぎる**
- てかスライド作るの初めてだし。無謀すぎぃぃ！！
- Googleスライドが白紙のまま、とりあえず挫折。
- 提案書の作り方からググり始める。

**5-2. スライドの構成や大枠を決める**
- めっっっっっちゃググった。伝え方に色んな法則あるんだね。情報量すごい。
- とりあえず流れを決めないと作るものも作れないので、タイトルのみのスライド作成
- どうせ誰にも見られないだろうと決め込んで(3回目)メモもおいていきますw
- [スライド構成メッチャググったメモはコチラ](https://github.com/Hirochon/GCI2020-Summer/blob/master/FinalTask/%E4%BC%9D%E3%82%8F%E3%82%8A%E3%81%9D%E3%81%86%E3%81%AA%E3%82%B9%E3%83%A9%E3%82%A4%E3%83%89%E6%A7%8B%E6%88%90%E3%82%92%E3%82%B0%E3%82%B0%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F.txt)

**5-3. 中身を作っていく**
- **恐らくどの工程よりも時間がかかりました**
1. デザイン決まんねえええええええええええええ
2. 図がきたねえええええええええ
3. 文字多いいいいいいいいいいいいい
4. 文字減らすと何言ってるかわかんねええええええ
5. てか伝わんねええええええええええええええええええ
6. あれ。これこーしたらええんちゃん×n (n→∞)

**5-4. 完成間近**
- 講座と関わりのない&前提知識がない友達に見せてみる
- 分かりづらい点がいくつも浮き彫りに(typoも)

**5-5. やっと完成**
- ほんとどんだけ時間と労力かかるんだよw

## データ分析に使ったNotebookは↓コチラ(多分GitHubじゃ表示できる時とできない時がございマス！よければクローンしてください！)
https://github.com/Hirochon/GCI2020-Summer/blob/master/FinalTask/Final_Task.ipynb

### 反省点
- 最後に修正しきれなかった点があった。
- でも最後までやりきれてよかった！

**とても長い期間でしたが、本当にお疲れ様でした！！！！**
